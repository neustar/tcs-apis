openapi: 3.0.3
info:
  x-logo:
    url: 'https://raw.githubusercontent.com/neustar/tcs-apis/main/docs/newNeustarLogo.jpeg'
    altText: 3GPP Authentication & Verification Service APIs
  title: 3GPP-based Call Authentication APIs
  description: Definition of the Application Server HTTP messages and data types for signing and verification using the Ms reference point. These APIs are designed to be compliant with the referenced 3GPP specification, while also including several optional enhancements.  Such enhancements may or may not be brought back into the 3GPP CT1 working group for consideration.
  contact: {}
  version: '1.0, TS 24.229, Release 17.8.1'
servers:
  - url: http://localhost:8080/stir/v1
    description: signing resource URI 
tags:
  - name: signing
    description: Used to construct a PASSporT "shaken" JSON Web Token, a PASSporT "div" JSON Web Token or a PASSporT "rph" JSON Web Token.  Also, referred to as the Secure Telephone Identity Authentication Service (STI-AS).
  - name: verification
    description: Used to verify one or more PASSporT JSON Web Tokens (or Identity headers).  Also, referred to as the STI Verification Service (STI-VS).
paths:
  /signing:
    post:
      tags:
        - signing
      summary: Signing (STI-AS) Request
      operationId: signingPOST
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/signingRequest'
      x-code-samples:
        - lang: curl
          label: SHAKEN
          source: |
            Request: 
            {
              "attest": "A",
              "dest": [
                {
                  "tn": [
                    "12155551212"
                  ]
                }
              ],
              "iat": 1664199282,
              "orig": {
                "tn": "12155551211"
              },
              "origid": "123e4567-e89b-12d3-a456-426655440000",
            }
            Response: 
            {
              identityHeader: "eyJhbGciOiJFUzI1NiIsInBwdCI6InNoYWtlbiIsInR5cCI6InBhc3Nwb3J0IiwieDV1IjoiaHR0cDovL05FVS1DMDJGRzJLN01MODU6ODA4MC9jY2lkL2F1dGhuL3YyL2NlcnRzLzExMDAxLjEwMDAxIn0.eyJhdHRlc3QiOiJBIiwiZGVzdCI6eyJ0biI6WyIxNTcxNTU1MDAwMCJdfSwiaWF0IjoxNjQ5NTM2NTMxLCJvcmlnIjp7InVyaSI6InNpcDphbGljZUBleGFtcGxlLmNvbSJ9LCJvcmlnaWQiOiJjODcyNDU3NS1iNzgxLTExZWMtYjU3NC0wMjQyYWMxMTAwMDIifQ.piGZhwqwWaKM4cOcrDTMeFKOY5UlekVDlKZTxlge4x0ERnSe9uW4400gaoVFdpGiTOzoCt9QdSfwLV_hcmvT0g;info=<http://NEU-C02FG2K7ML85:8080/ccid/authn/v2/certs/11001.10001>;alg=ES256;ppt=\"shaken\""
            }
        - lang: curl
          label: SHAKEN w/PPT
          source: |
            Request: 
            {
              "ppt": "shaken"
              "attest": "A",
              "dest": [
                {
                  "tn": [
                    "12155551212"
                  ]
                }
              ],
              "iat": 1664199282,
              "orig": {
                "tn": "12155551211"
              },
              "origid": "123e4567-e89b-12d3-a456-426655440000",
            }
            Response: 
            {
              identityHeader: "eyJhbGciOiJFUzI1NiIsInBwdCI6InNoYWtlbiIsInR5cCI6InBhc3Nwb3J0IiwieDV1IjoiaHR0cDovL05FVS1DMDJGRzJLN01MODU6ODA4MC9jY2lkL2F1dGhuL3YyL2NlcnRzLzExMDAxLjEwMDAxIn0.eyJhdHRlc3QiOiJBIiwiZGVzdCI6eyJ0biI6WyIxNTcxNTU1MDAwMCJdfSwiaWF0IjoxNjQ5NTM2NTMxLCJvcmlnIjp7InVyaSI6InNpcDphbGljZUBleGFtcGxlLmNvbSJ9LCJvcmlnaWQiOiJjODcyNDU3NS1iNzgxLTExZWMtYjU3NC0wMjQyYWMxMTAwMDIifQ.piGZhwqwWaKM4cOcrDTMeFKOY5UlekVDlKZTxlge4x0ERnSe9uW4400gaoVFdpGiTOzoCt9QdSfwLV_hcmvT0g;info=<http://NEU-C02FG2K7ML85:8080/ccid/authn/v2/certs/11001.10001>;alg=ES256;ppt=\"shaken\""
            }
      responses:
        '200':
          description: OK
          content:
            'application/json':
              schema:
                $ref: '#/components/schemas/signingResponse'
              examples: 
                shaken:
                  value: 
                    identityHeader: "eyJhbGciOiJFUzI1NiIsInBwdCI6InNoYWtlbiIsInR5cCI6InBhc3Nwb3J0IiwieDV1IjoiaHR0cDovL05FVS1DMDJGRzJLN01MODU6ODA4MC9jY2lkL2F1dGhuL3YyL2NlcnRzLzExMDAxLjEwMDAxIn0.eyJhdHRlc3QiOiJBIiwiZGVzdCI6eyJ0biI6WyIxNTcxNTU1MDAwMCJdfSwiaWF0IjoxNjQ5NTM2NTMxLCJvcmlnIjp7InVyaSI6InNpcDphbGljZUBleGFtcGxlLmNvbSJ9LCJvcmlnaWQiOiJjODcyNDU3NS1iNzgxLTExZWMtYjU3NC0wMjQyYWMxMTAwMDIifQ.piGZhwqwWaKM4cOcrDTMeFKOY5UlekVDlKZTxlge4x0ERnSe9uW4400gaoVFdpGiTOzoCt9QdSfwLV_hcmvT0g;info=<http://NEU-C02FG2K7ML85:8080/ccid/authn/v2/certs/11001.10001>;alg=ES256;ppt=\"shaken\""
                div: 
                  value: 
                    identityHeader: "kjytrfvbOiJFUzI1NiIsInBwdCI6InNoYWtlbiIsInR5cCI6InBhc3Nwb3J0IiwieDV1IjoiaHR0cDovL05FVS1DMDJGRzJLN01MODU6ODA4MC9jY2lkL2F1dGhuL3YyL2NlcnRzLzExMDAxLjEwMDAxIn0.eyJhdHRlc3QiOiJBIiwiZGVzdCI6eyJ0biI6WyIxNTcxNTU1MDAwMCJdfSwiaWF0IjoxNjQ5NTM2NTMxLCJvcmlnIjp7InVyaSI6InNpcDphbGljZUBleGFtcGxlLmNvbSJ9LCJvcmlnaWQiOiJjODcyNDU3NS1iNzgxLTExZWMtYjU3NC0wMjQyYWMxMTAwMDIifQ.piGZhwqwWaKM4cOcrDTMeFKOY5UlekVDlKZTxlge4x0ERnSe9uW4400gaoVFdpGiTOzoCt9QdSfwLV_hcmvT0g;info=<http://NEU-C02FG2K7ML85:8080/ccid/authn/v2/certs/11001.10001>;alg=ES256;ppt=\"div\""
                rph:  
                  value: 
                    identityHeader: "mnbvfrewqaJFUzI1NiIsInBwdCI6InNoYWtlbiIsInR5cCI6InBhc3Nwb3J0IiwieDV1IjoiaHR0cDovL05FVS1DMDJGRzJLN01MODU6ODA4MC9jY2lkL2F1dGhuL3YyL2NlcnRzLzExMDAxLjEwMDAxIn0.eyJhdHRlc3QiOiJBIiwiZGVzdCI6eyJ0biI6WyIxNTcxNTU1MDAwMCJdfSwiaWF0IjoxNjQ5NTM2NTMxLCJvcmlnIjp7InVyaSI6InNpcDphbGljZUBleGFtcGxlLmNvbSJ9LCJvcmlnaWQiOiJjODcyNDU3NS1iNzgxLTExZWMtYjU3NC0wMjQyYWMxMTAwMDIifQ.piGZhwqwWaKM4cOcrDTMeFKOY5UlekVDlKZTxlge4x0ERnSe9uW4400gaoVFdpGiTOzoCt9QdSfwLV_hcmvT0g;info=<http://NEU-C02FG2K7ML85:8080/ccid/authn/v2/certs/11001.10001>;alg=ES256;ppt=\"rph\""
        '400':
          description: Service error in processing request 
          content:
            application/json:
              examples:
                missingRequestBody:
                  summary: Missing Request Body
                  value:
                    error: Missing Request body
                missingMandatoryParameter:
                  summary: Missing Mandatory Parameter
                  value:
                    error: Missing Mandatory Parameter
                invalidParameterValue:
                  summary: Invalid Parameter Value
                  value:
                    error: Invalid Parameter Value
                failedToParseMessageBody:
                  summary: Failed To Parse Message Body
                  value:
                    error: Failed To Parse Message Body
        '406':
          description: Service error in processing request 
          content:
            application/json:
              schema: 
                required: 
                  - error
                type: object
                properties: 
                  error: 
                    type: string
                    example: Requested response body type is not supported
                    description: The request could not be processed due to a not supported message body format
        '404':
          description: Service error in processing request 
          content:
            application/json:
              schema: 
                required: 
                  - error
                type: object
                properties: 
                  error: 
                    type: string
                    example: Requested resource not found
                    description: The request could not be processed due to no resource available related to the Request-URI
        '415':
          description: Service error in processing request 
          content:
            application/json:
              schema: 
                required: 
                  - error
                type: object
                properties: 
                  error: 
                    type: string
                    example: Unsupported request body type
                    description: The request could not be processed due to not supported message body
        '411':
          description: Service error in processing request 
          content:
            application/json:
              schema: 
                required: 
                  - error
                type: object
                properties: 
                  error: 
                    type: string
                    example: Missing mandatory Content-Length headers
                    description: The request could not be processed due to a missing Content-Length header
        '405':
          description: Policy error in processing request 
          content:
            application/json:
              schema: 
                required: 
                  - error
                type: object
                properties: 
                  error: 
                    type: string
                    example: Method not allowed
                    description: The resource was invoked with unsupported operation
        '500':
          description: Policy error in processing request 
          content:
            application/json:
              schema: 
                required: 
                  - error
                type: object
                properties: 
                  error: 
                    type: string
                    example: Internal server error
                    description: The request failed due to internal error
  /divSigning:
    post:
      tags:
        - signing
      summary: Diversion (or Call Forwarding) Signing (STI-AS) Request
      operationId: divSigningPOST
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/divSigningRequest'
      x-code-samples:
        - lang: curl
          label: w/History-Info Header
          source: |
            Request: 
            {
              "dest": [
                {
                  "uri": [
                    "sip:Voice_Mail@example.com"
                  ]
                },
              ],
              "div": {
                "tn": "121555551212",
                "hi": "1.1"
              },
              "iat": 1664199282,
              "orig": {
                "tn": "12155551211"
              }
            }
      responses:
        '200':
          description: OK
          content:
            'application/json':
              schema:
                $ref: '#/components/schemas/divSigningResponse'
        '400':
          description: Service error in processing request 
          content:
            application/json:
              examples:
                missingRequestBody:
                  summary: Missing Request Body
                  value:
                    error: Missing request body
                missingMandatoryParameter:
                  summary: Missing Mandatory Parameter
                  value:
                    error: Missing Mandatory Parameter
                invalidParameterValue:
                  summary: Invalid Parameter Value
                  value:
                    error: Invalid Parameter Value
                failedToParseMessageBody:
                  summary: Failed To Parse Message Body
                  value:
                    error: Failed To Parse Message Body
        '406':
          description: Service error in processing request 
          content:
            application/json:
              schema: 
                required: 
                  - error
                type: object
                properties: 
                  error: 
                    type: string
                    example: Requested response body type is not supported
                    description: The request could not be processed due to a not supported message body format
        '404':
          description: Service error in processing request 
          content:
            application/json:
              schema: 
                required: 
                  - error
                type: object
                properties: 
                  error: 
                    type: string
                    example: Requested resource not found
                    description: The request could not be processed due to no resource available related to the Request-URI
        '415':
          description: Service error in processing request 
          content:
            application/json:
              schema: 
                required: 
                  - error
                type: object
                properties: 
                  error: 
                    type: string
                    example: Unsupported request body type
                    description: The request could not be processed due to not supported message body
        '411':
          description: Service error in processing request 
          content:
            application/json:
              schema: 
                required: 
                  - error
                type: object
                properties: 
                  error: 
                    type: string
                    example: Missing mandatory Content-Length headers
                    description: The request could not be processed due to a missing Content-Length header
        '405':
          description: Policy error in processing request 
          content:
            application/json:
              schema: 
                required: 
                  - error
                type: object
                properties: 
                  error: 
                    type: string
                    example: Method not allowed
                    description: The resource was invoked with unsupported operation
        '500':
          description: Policy error in processing request 
          content:
            application/json:
              schema: 
                required: 
                  - error
                type: object
                properties: 
                  error: 
                    type: string
                    example: Internal server error
                    description: The request failed due to internal error
  /rphSigning:
    post:
      tags:
        - signing
      summary: Resource Priority Header (RPH) Signing (STI-AS) Request
      operationId: rphSigningPOST
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/rphSigningRequest'
      x-code-samples:
        - lang: curl
          label: Without SPH
          source: |
            Request: 
            {
              "dest": [
                {
                  "tn": [
                    "12155551212"
                  ]
                }
              ],
              "iat": 1664199282,
              "orig": {
                "tn": "12155551211"
              },
              "rph": [
                {
                  "ets.0",
                  "wps.0"
                }
              ]
            }
      responses:
        '200':
          description: OK
          content:
            'application/json':
              schema:
                $ref: '#/components/schemas/rphSigningResponse'
        '400':
          description: Service error in processing request 
          content:
            application/json:
              examples:
                missingRequestBody:
                  summary: Missing Request Body
                  value:
                    error: Missing request body
                missingMandatoryParameter:
                  summary: Missing Mandatory Parameter
                  value:
                    error: Missing Mandatory Parameter
                invalidParameterValue:
                  summary: Invalid Parameter Value
                  value:
                    error: Invalid Parameter Value
                failedToParseMessageBody:
                  summary: Failed To Parse Message Body
                  value:
                    error: Failed To Parse Message Body
        '406':
          description: Service error in processing request 
          content:
            application/json:
              schema: 
                required: 
                  - error
                type: object
                properties: 
                  error: 
                    type: string
                    example: Requested response body type is not supported
                    description: The request could not be processed due to a not supported message body format
        '404':
          description: Service error in processing request 
          content:
            application/json:
              schema: 
                required: 
                  - error
                type: object
                properties: 
                  error: 
                    type: string
                    example: Requested resource not found
                    description: The request could not be processed due to no resource available related to the Request-URI
        '415':
          description: Service error in processing request 
          content:
            application/json:
              schema: 
                required: 
                  - error
                type: object
                properties: 
                  error: 
                    type: string
                    example: Unsupported request body type
                    description: The request could not be processed due to not supported message body
        '411':
          description: Service error in processing request 
          content:
            application/json:
              schema: 
                required: 
                  - error
                type: object
                properties: 
                  error: 
                    type: string
                    example: Missing mandatory Content-Length headers
                    description: The request could not be processed due to a missing Content-Length header
        '405':
          description: Policy error in processing request 
          content:
            application/json:
              schema: 
                required: 
                  - error
                type: object
                properties: 
                  error: 
                    type: string
                    example: Method not allowed
                    description: The resource was invoked with unsupported operation
        '500':
          description: Policy error in processing request 
          content:
            application/json:
              schema: 
                required: 
                  - error
                type: object
                properties: 
                  error: 
                    type: string
                    example: Internal server error
                    description: The request failed due to internal error
  /verification:
    post:
      tags:
        - verification
      summary: Verification (STI-VS) Request
      operationId: verificationPost
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/verificationRequest'
      x-code-samples:
        - lang: curl
          label: SHAKEN
          source: |
            Request: 
            {
              "identityHeader": "eyJhbGciOiJFUzI1NiIsInBwdCI6InNoYWtlbiIsInR5cCI6InBhc3Nwb3J0IiwieDV1IjoiaHR0cDovL05FVS1DMDJGRzJLN01MODU6ODA4MC9jY2lkL2F1dGhuL3YyL2NlcnRzLzExMDAxLjEwMDAxIn0.eyJhdHRlc3QiOiJBIiwiZGVzdCI6eyJ0biI6WyIxNTcxNTU1MDAwMCJdfSwiaWF0IjoxNjQ5NTM2NTMxLCJvcmlnIjp7InVyaSI6InNpcDphbGljZUBleGFtcGxlLmNvbSJ9LCJvcmlnaWQiOiJjODcyNDU3NS1iNzgxLTExZWMtYjU3NC0wMjQyYWMxMTAwMDIifQ.piGZhwqwWaKM4cOcrDTMeFKOY5UlekVDlKZTxlge4x0ERnSe9uW4400gaoVFdpGiTOzoCt9QdSfwLV_hcmvT0g;info=<http://NEU-C02FG2K7ML85:8080/ccid/authn/v2/certs/11001.10001>;alg=ES256;ppt=\"shaken\"",
              "to": "sip:Alice@example.com or 12155551213",
              "time": 1664216863,
              "from": "sip:Alice@example.com or 12155551211"
            }

            Response: 
            {
              "verstatValue":"TN-Validation-Passed",
              "verifyResults":[
                  {
                    "verifyResult":[
                        {
                          "ppt":"shaken",
                          "status":"pass",
                          "validClaims":{
                              "attest":"A , B or C",
                              "dest":{
                                "tn":[
                                  "12155551213"
                                ],
                                "uri":null
                              },
                              "iat":1664199282,
                              "orig":{
                                "tn":"12155551211"
                              },
                              "origid":"123e4567-e89b-12d3-a456-426655440000"
                          }
                        }
                    ]
                  }
              ]
            }
      responses:
        '200':
          description: OK
          content:
            'application/json':
              schema:
                $ref: '#/components/schemas/verificationResponse'
        '400':
          description: Service error in processing request 
          content:
            application/json:
              examples:
                missingRequestBody:
                  summary: Missing Request Body
                  value:
                    error: Missing request body
                missingMandatoryParameter:
                  summary: Missing Mandatory Parameter
                  value:
                    error: Missing Mandatory Parameter
                invalidParameterValue:
                  summary: Invalid Parameter Value
                  value:
                    error: Invalid Parameter Value
                failedToParseMessageBody:
                  summary: Failed To Parse Message Body
                  value:
                    error: Failed To Parse Message Body
        '406':
          description: Service error in processing request 
          content:
            application/json:
              schema: 
                required: 
                  - error
                type: object
                properties: 
                  error: 
                    type: string
                    example: Requested response body type is not supported
                    description: The request could not be processed due to a not supported message body format
        '404':
          description: Service error in processing request 
          content:
            application/json:
              schema: 
                required: 
                  - error
                type: object
                properties: 
                  error: 
                    type: string
                    example: Requested resource not found
                    description: The request could not be processed due to no resource available related to the Request-URI
        '415':
          description: Service error in processing request 
          content:
            application/json:
              schema: 
                required: 
                  - error
                type: object
                properties: 
                  error: 
                    type: string
                    example: Unsupported request body type
                    description: The request could not be processed due to not supported message body
        '411':
          description: Service error in processing request 
          content:
            application/json:
              schema: 
                required: 
                  - error
                type: object
                properties: 
                  error: 
                    type: string
                    example: Missing mandatory Content-Length headers
                    description: The request could not be processed due to a missing Content-Length header
        '405':
          description: Policy error in processing request 
          content:
            application/json:
              schema: 
                required: 
                  - error
                type: object
                properties: 
                  error: 
                    type: string
                    example: Method not allowed
                    description: The resource was invoked with unsupported operation
        '500':
          description: Policy error in processing request 
          content:
            application/json:
              schema: 
                required: 
                  - error
                type: object
                properties: 
                  error: 
                    type: string
                    example: Internal server error
                    description: The request failed due to internal error
  /divVerification:
    post:
      tags:
        - verification
      summary: Diversion (or Call Forwarding) Verification (STI-VS) Request
      operationId: divVerificationPost
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/divVerificationRequest'
      x-code-samples:
        - lang: curl
          label: 1 Diversion
          source: |
            Request: 
            {
              "identityHeaders": ["eyJhbGciOiJFUzI1NiIsInBwdCI6InNoYWtlbiIsInR5cCI6InBhc3Nwb3J0IiwieDV1IjoiaHR0cDovL2NhLWNtcy5uZXVzdGFybGFiLmJpei9jY2lkL2F1dGhuL3YyL2NlcnRzLzExMDE1LjEwMDAxIn0.eyJhdHRlc3QiOiJBIiwiZGVzdCI6eyJ0biI6WyIxNTcxNTU1MDAwMCJdfSwiaWF0IjoxNjM4MzkzNjE0LCJvcmlnIjp7InRuIjoiMTcwMzU1NTAwMDEifSwib3JpZ2lkIjoiZTUxNzM3MDMtYWNjZS00MzM4LTg3ODYtZDEzNDg2Y2I0MjM2IiwicmNkIjp7Im5hbSI6IkFsaWNlIn0sInJjZGkiOnsiL25hbSI6InNoYTI1Ni1POFVRWXBjOFJZMWFieTJOWktBakpHTlVyWDRHU3g1T0FKN0lvR21hTUVNPSJ9fQ.8h3_745L_J8VyJyp3TL5woU6HsJLruc_7yT9FreBHXF6YfS4ZUGeKIK4HuFAWzKEakoEWvM5nZgvcwAmqxbn4w;info=<http://ca-cms.neustarlab.biz/ccid/authn/v2/certs/11015.10001>;alg=ES256;ppt=\"div\""],
              "from": ""\"Alice\" <sip:+17035550001@example.com>",
              "to": "\"John\" <sip:+15715550002@example.com>",
              "dest": "\"Voice_Mail\" <sip:+15715550000@example.com>",
              "time": 1664216863,
              "protectedHeaders": "Diversion: sip:15715550002@10.10.100.12;reason=unknown;privacy=off"
            }
            Response: 
            {
              "divResult": [
                [
                  [
                    "15715550002",
                    "TN-Validation-Passed"
                  ]
                ]
              ],
              "verifyResults": [
                {
                  "verifyResult": [
                    {
                      "ppt": "div",
                      "status": "pass",
                      "validClaims": {
                        "dest": {
                          "tn": [
                            [
                              "15715550000"
                            ]
                          ],
                          "uri": null
                        },
                        "iat": 1664199282,
                        "orig": {
                          "tn": "17035550001"
                        },
                        "div": {
                          "tn": "15715550002",
                          "hi": null
                        }
                      }
                    }
                  ]
                }
              ]
            }
        - lang: curl
          label: 1 Diversion - Fail
          source: |
            Request: 
            {
              "identityHeaders": ["eyJhbGciOiJFUzI1NiIsInBwdCI6InNoYWtlbiIsInR5cCI6InBhc3Nwb3J0IiwieDV1IjoiaHR0cDovL2NhLWNtcy5uZXVzdGFybGFiLmJpei9jY2lkL2F1dGhuL3YyL2NlcnRzLzExMDE1LjEwMDAxIn0.eyJhdHRlc3QiOiJBIiwiZGVzdCI6eyJ0biI6WyIxNTcxNTU1MDAwMCJdfSwiaWF0IjoxNjM4MzkzNjE0LCJvcmlnIjp7InRuIjoiMTcwMzU1NTAwMDEifSwib3JpZ2lkIjoiZTUxNzM3MDMtYWNjZS00MzM4LTg3ODYtZDEzNDg2Y2I0MjM2IiwicmNkIjp7Im5hbSI6IkFsaWNlIn0sInJjZGkiOnsiL25hbSI6InNoYTI1Ni1POFVRWXBjOFJZMWFieTJOWktBakpHTlVyWDRHU3g1T0FKN0lvR21hTUVNPSJ9fQ.8h3_745L_J8VyJyp3TL5woU6HsJLruc_7yT9FreBHXF6YfS4ZUGeKIK4HuFAWzKEakoEWvM5nZgvcwAmqxbn4w;info=<http://ca-cms.neustarlab.biz/ccid/authn/v2/certs/11015.10001>;alg=ES256;ppt=\"div\""],
              "from": ""\"Alice\" <sip:+17035550001@example.com>",
              "to": "\"John\" <sip:+15715550002@example.com>",
              "dest": "\"Voice_Mail\" <sip:+15715550000@example.com>",
              "time": 1664216863,
              "protectedHeaders": "Diversion: sip:15715550002@10.10.100.12;reason=unknown;privacy=off"
            }
            Response: 
            {
              "divResult":[
                  [
                    "15715550002,TN-Validation-Failed"
                  ]
              ],
              "verifyResults":[
                  {
                    "verifyResult":[
                        {
                          "ppt":"div",
                          "status":"fail"
                          "reasonCode":438,
                          "reasonText":"Failure Reason",
                          "passport":"eyJhbGciOiJFUzI1NiIsInBwdCI6InNoYWtlbiIsInR5cCI6InBhc3Nwb3J0IiwieDV1IjoiaHR0cDovL2NhLWNtcy5uZXVzdGFybGFiLmJpei9jY2lkL2F1dGhuL3YyL2NlcnRzLzExMDE1LjEwMDAxIn0.eyJhdHRlc3QiOiJBIiwiZGVzdCI6eyJ0biI6WyIxNTcxNTU1MDAwMCJdfSwiaWF0IjoxNjM4MzkzNjE0LCJvcmlnIjp7InRuIjoiMTcwMzU1NTAwMDEifSwib3JpZ2lkIjoiZTUxNzM3MDMtYWNjZS00MzM4LTg3ODYtZDEzNDg2Y2I0MjM2IiwicmNkIjp7Im5hbSI6IkFsaWNlIn0sInJjZGkiOnsiL25hbSI6InNoYTI1Ni1POFVRWXBjOFJZMWFieTJOWktBakpHTlVyWDRHU3g1T0FKN0lvR21hTUVNPSJ9fQ.8h3_745L_J8VyJyp3TL5woU6HsJLruc_7yT9FreBHXF6YfS4ZUGeKIK4HuFAWzKEakoEWvM5nZgvcwAmqxbn4w"
                        }
                    ]
                  }
              ]
            }
        # - lang: curl
        #   label: 2 Diversion
        #   source: |
        #     Request: 
        #     {
        #       "identityHeaders": [
        #         "eyJhbGciOiJFUzI1NiIsInBwdCI6ImRpdiIsInR5cCI6InBhc3Nwb3J0IiwieDV1IjoiaHR0cDovL2NhLWNtcy5uZXVzdGFybGFiLmJpei9jY2lkL2F1dGhuL3YyL2NlcnRzLzExMDE1LjEwMDAxIn0.eyJkZXN0Ijp7InRuIjpbIjE1NzE1NTUwMDAyIl19LCJkaXYiOnsidG4iOiIxNTcxNTU1MDAwMCJ9LCJpYXQiOjE2MzgzOTM4NjksIm9yaWciOnsidG4iOiIxNzAzNTU1MDAwMSJ9fQ.Hc73JFhnXgocq9q0nldHR5SdMHNBftGfQouslhDT0BPhGmcCnOGiN9L-J3CQsbd2z7wA6hqVSC2gAfPc7lSYiQ;info=<http://ca-cms.neustarlab.biz/ccid/authn/v2/certs/11015.10001>;alg=ES256;ppt=\"div\"",
        #         "eyJhbGciOiJFUzI1NiIsInBwdCI6ImRpdiIsInR5cCI6InBhc3Nwb3J0IiwieDV1IjoiaHR0cDovL2NhLWNtcy5uZXVzdGFybGFiLmJpei9jY2lkL2F1dGhuL3YyL2NlcnRzLzExMDE1LjEwMDAxIn0.eyJkZXN0Ijp7InRuIjpbIjE1NzE1NTUwMDAzIl19LCJkaXYiOnsidG4iOiIxNTcxNTU1MDAwMiJ9LCJpYXQiOjE2MzgzOTQxODgsIm9yaWciOnsidG4iOiIxNzAzNTU1MDAwMSJ9fQ.Y9BbjcndUXyMZl6j1GsQpYgGE7VpPobLmwIqcYNELu3Cx0phwVEHre0TQHZiQB5N-Vbl-GveTphJDkfbfStBkA;info=<http://ca-cms.neustarlab.biz/ccid/authn/v2/certs/11015.10001>;alg=ES256;ppt=\"div\""
        #       ],
        #       "from": "\"Alice\" <sip:+17035550001@example.com>",
        #       "to": "\"Rob\" <sip:+15715550003@example.com>",
        #       "dest": "\"Voice_Mail\" <sip:+15715550000@example.com>",
        #       "time": 1664216863,
        #       "protectedHeaders": "Diversion: sip:15715550003@10.10.100.12;reason=unknown;privacy=off"
        #     }
        #     Response: 
        #     {
        #       "divResult":[
        #           [
        #             "15715550000,TN-Validation-Passed",
        #             "15715550002,TN-Validation-Passed"
        #           ]
        #       ],
        #       "verifyResults":[
        #           {
        #             "verifyResult":[
        #                 {
        #                   "reasonCode":400,
        #                   "reasonText":"Failure Reason",
        #                   "passport":"kjhytrciOiJFUzI1NiIsInBwdCI6InNoYWtlbiIsInR5cCI6InBhc3Nwb3J0IiwieDV1IjoiaHR0cDovL05FVS1DMDJGRzJLN01MODU6ODA4MC9jY2lkL2F1dGhuL3YyL2NlcnRzLzExMDAxLjEwMDAxIn0.eyJhdHRlc3QiOiJBIiwiZGVzdCI6eyJ0biI6WyIxNTcxNTU1MDAwMCJdfSwiaWF0IjoxNjQ5NTM2NTMxLCJvcmlnIjp7InVyaSI6InNpcDphbGljZUBleGFtcGxlLmNvbSJ9LCJvcmlnaWQiOiJjODcyNDU3NS1iNzgxLTExZWMtYjU3NC0wMjQyYWMxMTAwMDIifQ.piGZhwqwWaKM4cOcrDTMeFKOY5UlekVDlKZTxlge4x0ERnSe9uW4400gaoVFdpGiTOzoCt9QdSfwLV_hcmvT0g;info=<http://NEU-C02FG2K7ML85:8080/ccid/authn/v2/certs/11001.10001>;alg=ES256;ppt=\"shaken\"",
        #                   "validClaims":{
        #                       "ppt":"div",
        #                       "attest":"A",
        #                       "dest":{
        #                         "tn":[
        #                             [
        #                               "12155551212"
        #                             ]
        #                         ],
        #                         "uri":[
        #                             [
        #                               "sip:Voice_Mail@example.com"
        #                             ]
        #                         ]
        #                       },
        #                       "iat":1664199282,
        #                       "orig":{
        #                         "tn":"12155551211"
        #                       },
        #                       "origid":"123e4567-e89b-12d3-a456-426655440000",
        #                       "rph":[
        #                         {
        #                             "ets.0",
        #                             "wps.0"
        #                         }
        #                       ],
        #                       "sph":"psap-callback",
        #                       "div":{
        #                         "tn":"121555551212",
        #                         "hi":null
        #                       }
        #                   }
        #                 },
        #                 {
        #                   "reasonCode":400,
        #                   "reasonText":"Failure Reason",
        #                   "passport":"kjhytrciOiJFUzI1NiIsInBwdCI6InNoYWtlbiIsInR5cCI6InBhc3Nwb3J0IiwieDV1IjoiaHR0cDovL05FVS1DMDJGRzJLN01MODU6ODA4MC9jY2lkL2F1dGhuL3YyL2NlcnRzLzExMDAxLjEwMDAxIn0.eyJhdHRlc3QiOiJBIiwiZGVzdCI6eyJ0biI6WyIxNTcxNTU1MDAwMCJdfSwiaWF0IjoxNjQ5NTM2NTMxLCJvcmlnIjp7InVyaSI6InNpcDphbGljZUBleGFtcGxlLmNvbSJ9LCJvcmlnaWQiOiJjODcyNDU3NS1iNzgxLTExZWMtYjU3NC0wMjQyYWMxMTAwMDIifQ.piGZhwqwWaKM4cOcrDTMeFKOY5UlekVDlKZTxlge4x0ERnSe9uW4400gaoVFdpGiTOzoCt9QdSfwLV_hcmvT0g;info=<http://NEU-C02FG2K7ML85:8080/ccid/authn/v2/certs/11001.10001>;alg=ES256;ppt=\"shaken\"",
        #                   "validClaims":{
        #                       "ppt":"div",
        #                       "attest":"A",
        #                       "dest":{
        #                         "tn":[
        #                             [
        #                               "12155551212"
        #                             ]
        #                         ],
        #                         "uri":[
        #                             [
        #                               "sip:Voice_Mail@example.com"
        #                             ]
        #                         ]
        #                       },
        #                       "iat":1664199282,
        #                       "orig":{
        #                         "tn":"12155551211"
        #                       },
        #                       "origid":"123e4567-e89b-12d3-a456-426655440000",
        #                       "rph":[
        #                         {
        #                             "ets.0",
        #                             "wps.0"
        #                         }
        #                       ],
        #                       "sph":"psap-callback",
        #                       "div":{
        #                         "tn":"121555551212",
        #                         "hi":null
        #                       }
        #                   }
        #                 }
        #             ],
        #             "ppt":"div",
        #             "status":"pass"
        #           }
        #       ]
        #     }
      responses:
        '200':
          description: OK
          content:
            'application/json':
              schema:
                $ref: '#/components/schemas/divVerificationResponse'
        '400':
          description: Service error in processing request 
          content:
            application/json:
              examples:
                missingRequestBody:
                  summary: Missing Request Body
                  value:
                    error: Missing request body
                missingMandatoryParameter:
                  summary: Missing Mandatory Parameter
                  value:
                    error: Missing Mandatory Parameter
                invalidParameterValue:
                  summary: Invalid Parameter Value
                  value:
                    error: Invalid Parameter Value
                failedToParseMessageBody:
                  summary: Failed To Parse Message Body
                  value:
                    error: Failed To Parse Message Body
        '406':
          description: Service error in processing request 
          content:
            application/json:
              schema: 
                required: 
                  - error
                type: object
                properties: 
                  error: 
                    type: string
                    example: Requested response body type is not supported
                    description: The request could not be processed due to a not supported message body format
        '404':
          description: Service error in processing request 
          content:
            application/json:
              schema: 
                required: 
                  - error
                type: object
                properties: 
                  error: 
                    type: string
                    example: Requested resource not found
                    description: The request could not be processed due to no resource available related to the Request-URI
        '415':
          description: Service error in processing request 
          content:
            application/json:
              schema: 
                required: 
                  - error
                type: object
                properties: 
                  error: 
                    type: string
                    example: Unsupported request body type
                    description: The request could not be processed due to not supported message body
        '411':
          description: Service error in processing request 
          content:
            application/json:
              schema: 
                required: 
                  - error
                type: object
                properties: 
                  error: 
                    type: string
                    example: Missing mandatory Content-Length headers
                    description: The request could not be processed due to a missing Content-Length header
        '405':
          description: Policy error in processing request 
          content:
            application/json:
              schema: 
                required: 
                  - error
                type: object
                properties: 
                  error: 
                    type: string
                    example: Method not allowed
                    description: The resource was invoked with unsupported operation
        '500':
          description: Policy error in processing request 
          content:
            application/json:
              schema: 
                required: 
                  - error
                type: object
                properties: 
                  error: 
                    type: string
                    example: Internal server error
                    description: The request failed due to internal error
  /rphVerification:
    post:
      tags:
        - verification
      summary: RPH Verification (STI-VS) Request
      operationId: rphVerificationPost
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/rphVerificationRequest'
      responses:
        '200':
          description: OK
          content:
            'application/json':
              schema:
                $ref: '#/components/schemas/rphVerificationResponse'
        '400':
          description: Service error in processing request 
          content:
            application/json:
              examples:
                missingRequestBody:
                  summary: Missing Request Body
                  value:
                    error: Missing request body
                missingMandatoryParameter:
                  summary: Missing Mandatory Parameter
                  value:
                    error: Missing Mandatory Parameter
                invalidParameterValue:
                  summary: Invalid Parameter Value
                  value:
                    error: Invalid Parameter Value
                failedToParseMessageBody:
                  summary: Failed To Parse Message Body
                  value:
                    error: Failed To Parse Message Body
        '406':
          description: Service error in processing request 
          content:
            application/json:
              schema: 
                required: 
                  - error
                type: object
                properties: 
                  error: 
                    type: string
                    example: Requested response body type is not supported
                    description: The request could not be processed due to a not supported message body format
        '404':
          description: Service error in processing request 
          content:
            application/json:
              schema: 
                required: 
                  - error
                type: object
                properties: 
                  error: 
                    type: string
                    example: Requested resource not found
                    description: The request could not be processed due to no resource available related to the Request-URI
        '415':
          description: Service error in processing request 
          content:
            application/json:
              schema: 
                required: 
                  - error
                type: object
                properties: 
                  error: 
                    type: string
                    example: Unsupported request body type
                    description: The request could not be processed due to not supported message body
        '411':
          description: Service error in processing request 
          content:
            application/json:
              schema: 
                required: 
                  - error
                type: object
                properties: 
                  error: 
                    type: string
                    example: Missing mandatory Content-Length headers
                    description: The request could not be processed due to a missing Content-Length header
        '405':
          description: Policy error in processing request 
          content:
            application/json:
              schema: 
                required: 
                  - error
                type: object
                properties: 
                  error: 
                    type: string
                    example: Method not allowed
                    description: The resource was invoked with unsupported operation
        '500':
          description: Policy error in processing request 
          content:
            application/json:
              schema: 
                required: 
                  - error
                type: object
                properties: 
                  error: 
                    type: string
                    example: Internal server error
                    description: The request failed due to internal error
components:
  schemas:
    signingRequest:
      title: signingRequest
      type: object
      required: 
        - dest
        - iat
        - orig
      properties:
        ppt:
          type: string
          example: shaken, div or rph
          description: Optional field. If it's empty, then request is considered as "shaken" request. If "div", then request is considered as "divSigning" request and if "rph", then request is considered as "rphSigning" request
        attest: 
          type: string
          example: A , B or C
          description: Identifying the relation between the service provider attesting the identity and the subscriber
        dest:
          type: object
          description: Identifying the called user taken from the To header field for a "shaken" or "rph" PASSporT, and from the Request-URI after retargeting for a "div" PASSporT
          properties: 
            tn: 
              type: array
              description: Allowed characters as for local-number-digits and global-number-digits. The number needs to be in canonical form
              items:
                type: string
                example: "12155551213"
            uri: 
              type: array
              description: Used if the "orig" or "dest" is given in a SIP URI
              items:
                type: string
                example: null
        iat: 
          type: integer
          description: Time since 1 January 1970 in Numeric Date format
          example: 1664199282
        orig: 
          type: object
          description: Identifying the calling user
          example: {"tn":"12155551211"}
        origid: 
          type: string
          description: An opaque origination identifier in the recommended format of a Universally Unique Identifier (UUID)
          example: 123e4567-e89b-12d3-a456-426655440000
        rph: 
          type: array
          items:
            type: string
          description: Applicable only if "ppt" = "rph". Array of strings that correspond to the r-values indicated in the SIP Resource-Priority header field. Contains assertion of the priority level of the user to be used for a given communication session
          example: ["ets.0", "wps.0"]
        sph: 
          type: string
          description: Applicable only if "ppt" = "rph". Contains header field value "psap-callback" of the SIP Priority header field
          example: psap-callback
        div:
          type: object
          description: Applicable only if "ppt" = "div". Identifying the diverting user; i.e., the user identified in the Request-URI before retargeting
          properties: 
            tn:
              type: string
              description: Allowed characters as for local-number-digits and global-number-digits.The number needs to be in canonical form 
              example: "121555551212"
            uri:
              type: array
              description: Used if the "orig" or "dest" is given in a SIP URI
              example: null
            hi:
              type: string
              description: The "index" header field parameter is included in the entry identifying the diverting user in the History-Info header field
              example: null
    rphSigningRequest:
      title: signingRequest
      type: object
      required: 
        - dest
        - iat
        - orig
        - rph
      properties:
        dest:
          type: object
          description: Identifying the called user taken from the To header field for a "shaken" or "rph" PASSporT, and from the Request-URI after retargeting for a "div" PASSporT
          properties: 
            tn: 
              type: array
              description: Allowed characters as for local-number-digits and global-number-digits. The number needs to be in canonical form
              items:
                type: string
                example: "12155551212"
            uri: 
              type: array
              description: Used if the "orig" or "dest" is given in a SIP URI
              items:
                type: string
                example: null
        iat: 
          type: integer
          description: Time since 1 January 1970 in Numeric Date format
          example: 1664199282
        orig: 
          type: object
          description: Identifying the calling user
          example: {"tn":"12155551211"}
        rph: 
          type: array
          items:
            type: string
          description: Array of strings that correspond to the r-values indicated in the SIP Resource-Priority header field. Contains assertion of the priority level of the user to be used for a given communication session
          example: ["ets.0", "wps.0"]
        sph: 
          type: string
          description: Contains header field value "psap-callback" of the SIP Priority header field
          example: psap-callback
    divSigningRequest:
      title: signingRequest
      type: object
      required: 
        - dest
        - div
        - iat
        - orig
      properties:
        dest:
          type: object
          description: Identifying the called user taken from the To header field for a "shaken" or "rph" PASSporT, and from the Request-URI after retargeting for a "div" PASSporT
          properties: 
            tn: 
              type: array
              description: Allowed characters as for local-number-digits and global-number-digits. The number needs to be in canonical form
              items:
                type: string
                example: null
            uri: 
              type: array
              description: Used if the "orig" or "dest" is given in a SIP URI
              items:
                type: string
                example: "sip:Voice_Mail@example.com"
        div:
          type: object
          description: Identifying the diverting user; i.e., the user identified in the Request-URI before retargeting
          required: 
            - tn
          properties: 
            tn:
              type: string
              description: Allowed characters as for local-number-digits and global-number-digits.The number needs to be in canonical form 
              example: "121555551212"
            hi:
              type: string
              description: The "index" header field parameter is included in the entry identifying the diverting user in the History-Info header field
              example: null
        iat: 
          type: integer
          description: Time since 1 January 1970 in Numeric Date format
          example: 1664199282
        orig: 
          type: object
          description: Identifying the calling user
          example: {"tn":"12155551211"}
    signingResponse:
      title: signingResponse
      type: object
      required: 
        - identityHeader
      properties:
        identityHeader:
          type: string
          description: Identity header field value according to RFC 8224. This string cannot be NULL
    divSigningResponse:
      title: signingResponse
      type: object
      required: 
        - identityHeader
      properties:
        identityHeader:
          type: string
          description: Identity header field value according to RFC 8224. This string cannot be NULL
          example: "eyJhbGciOiJFUzI1NiIsInBwdCI6InNoYWtlbiIsInR5cCI6InBhc3Nwb3J0IiwieDV1IjoiaHR0cDovL05FVS1DMDJGRzJLN01MODU6ODA4MC9jY2lkL2F1dGhuL3YyL2NlcnRzLzExMDAxLjEwMDAxIn0.eyJhdHRlc3QiOiJBIiwiZGVzdCI6eyJ0biI6WyIxNTcxNTU1MDAwMCJdfSwiaWF0IjoxNjQ5NTM2NTMxLCJvcmlnIjp7InVyaSI6InNpcDphbGljZUBleGFtcGxlLmNvbSJ9LCJvcmlnaWQiOiJjODcyNDU3NS1iNzgxLTExZWMtYjU3NC0wMjQyYWMxMTAwMDIifQ.piGZhwqwWaKM4cOcrDTMeFKOY5UlekVDlKZTxlge4x0ERnSe9uW4400gaoVFdpGiTOzoCt9QdSfwLV_hcmvT0g;info=<http://NEU-C02FG2K7ML85:8080/ccid/authn/v2/certs/11001.10001>;alg=ES256;ppt=\"div\""
    rphSigningResponse:
      title: signingResponse
      type: object
      required: 
        - identityHeader
      properties:
        identityHeader:
          type: string
          description: Identity header field value according to RFC 8224. This string cannot be NULL
          example: "eyJhbGciOiJFUzI1NiIsInBwdCI6InNoYWtlbiIsInR5cCI6InBhc3Nwb3J0IiwieDV1IjoiaHR0cDovL05FVS1DMDJGRzJLN01MODU6ODA4MC9jY2lkL2F1dGhuL3YyL2NlcnRzLzExMDAxLjEwMDAxIn0.eyJhdHRlc3QiOiJBIiwiZGVzdCI6eyJ0biI6WyIxNTcxNTU1MDAwMCJdfSwiaWF0IjoxNjQ5NTM2NTMxLCJvcmlnIjp7InVyaSI6InNpcDphbGljZUBleGFtcGxlLmNvbSJ9LCJvcmlnaWQiOiJjODcyNDU3NS1iNzgxLTExZWMtYjU3NC0wMjQyYWMxMTAwMDIifQ.piGZhwqwWaKM4cOcrDTMeFKOY5UlekVDlKZTxlge4x0ERnSe9uW4400gaoVFdpGiTOzoCt9QdSfwLV_hcmvT0g;info=<http://NEU-C02FG2K7ML85:8080/ccid/authn/v2/certs/11001.10001>;alg=ES256;ppt=\"rph\""
    errorResponse400a:
      title: errorResponseMissingRequestBody
      type: object
      required: 
        - error
      properties:
        error:
          type: string
          description: The request could not be processed due to missing request body.          
          example: Missing request body
    errorResponse400b:
      title: errorResponseMissingMandatoryParameter
      type: object
      required: 
        - error
      properties:
        error:
          type: string
          description: The request could not be processed due to missing parameters.
          example: Missing mandatory parameter
    errorResponse400c:
      title: errorResponseInvalidParameterValue
      type: object
      required: 
        - error
      properties:
        error:
          type: string
          description: The request could not be processed due to invalid parameter value.
          example: Invalid parameter value
    errorResponse400d:
      title: errorResponseFailedToParseMessageBody
      type: object
      required: 
        - error
      properties:
        error:
          type: string
          description: The request could not be processed due to failure to parse the message body
          example: Failed to parse message body
    verificationRequest:
      title: verificationRequest
      type: object
      required: 
        - identityHeader
        - to
        - time
        - from
      properties:
        identityHeader:
          type: string
          description: This parameter contains a "shaken" Identity header field value to be verified
          example: "kjhytrciOiJFUzI1NiIsInBwdCI6InNoYWtlbiIsInR5cCI6InBhc3Nwb3J0IiwieDV1IjoiaHR0cDovL05FVS1DMDJGRzJLN01MODU6ODA4MC9jY2lkL2F1dGhuL3YyL2NlcnRzLzExMDAxLjEwMDAxIn0.eyJhdHRlc3QiOiJBIiwiZGVzdCI6eyJ0biI6WyIxNTcxNTU1MDAwMCJdfSwiaWF0IjoxNjQ5NTM2NTMxLCJvcmlnIjp7InVyaSI6InNpcDphbGljZUBleGFtcGxlLmNvbSJ9LCJvcmlnaWQiOiJjODcyNDU3NS1iNzgxLTExZWMtYjU3NC0wMjQyYWMxMTAwMDIifQ.piGZhwqwWaKM4cOcrDTMeFKOY5UlekVDlKZTxlge4x0ERnSe9uW4400gaoVFdpGiTOzoCt9QdSfwLV_hcmvT0g;info=<http://NEU-C02FG2K7ML85:8080/ccid/authn/v2/certs/11001.10001>;alg=ES256;ppt=\"shaken\""
        identityHeaders:
          type: array
          items:
            type: string
          description: This parameter contains one or more "div" and/or "rph" Identity header field values to be verified 
          example: ["mjhtrrciOiJFUzI1NiIsInBwdCI6InNoYWtlbiIsInR5cCI6InBhc3Nwb3J0IiwieDV1IjoiaHR0cDovL05FVS1DMDJGRzJLN01MODU6ODA4MC9jY2lkL2F1dGhuL3YyL2NlcnRzLzExMDAxLjEwMDAxIn0.eyJhdHRlc3QiOiJBIiwiZGVzdCI6eyJ0biI6WyIxNTcxNTU1MDAwMCJdfSwiaWF0IjoxNjQ5NTM2NTMxLCJvcmlnIjp7InVyaSI6InNpcDphbGljZUBleGFtcGxlLmNvbSJ9LCJvcmlnaWQiOiJjODcyNDU3NS1iNzgxLTExZWMtYjU3NC0wMjQyYWMxMTAwMDIifQ.piGZhwqwWaKM4cOcrDTMeFKOY5UlekVDlKZTxlge4x0ERnSe9uW4400gaoVFdpGiTOzoCt9QdSfwLV_hcmvT0g;info=<http://NEU-C02FG2K7ML85:8080/ccid/authn/v2/certs/11001.10001>;alg=ES256;ppt=\"div\"", 
                    "eyJhbGciOiJFUzI1NiIsInBwdCI6InNoYWtlbiIsInR5cCI6InBhc3Nwb3J0IiwieDV1IjoiaHR0cDovL05FVS1DMDJGRzJLN01MODU6ODA4MC9jY2lkL2F1dGhuL3YyL2NlcnRzLzExMDAxLjEwMDAxIn0.eyJhdHRlc3QiOiJBIiwiZGVzdCI6eyJ0biI6WyIxNTcxNTU1MDAwMCJdfSwiaWF0IjoxNjQ5NTM2NTMxLCJvcmlnIjp7InVyaSI6InNpcDphbGljZUBleGFtcGxlLmNvbSJ9LCJvcmlnaWQiOiJjODcyNDU3NS1iNzgxLTExZWMtYjU3NC0wMjQyYWMxMTAwMDIifQ.piGZhwqwWaKM4cOcrDTMeFKOY5UlekVDlKZTxlge4x0ERnSe9uW4400gaoVFdpGiTOzoCt9QdSfwLV_hcmvT0g;info=<http://NEU-C02FG2K7ML85:8080/ccid/authn/v2/certs/11001.10001>;alg=ES256;ppt=\"rph\""]
        to:
          type: string
          description: The destination identity taken from the To header field. Used when no "div" claim is included
          example: "sip:Bob@example.com or 12155551212"
        dest: 
          type: string
          description: The destination identity taken from the Request-URI in the incoming request
          example: "sip:Voice_Mail@example.com or 12155551213"
        time: 
          type: integer
          description: Time based on the Date header field in the incoming request
          example: 1664216863
        from: 
          type: string
          description: The asserted identity, taken from the P-Asserted-Identity or the From header field of the incoming request
          example: "sip:Alice@example.com or 12155551211"
        protectedHeaders: 
          type: array
          items:
            type: string
          description: Contains the SIP header field(s) protected by claims in the PASSporT(s) of the identityHeaders array (i.e., "rph" and/or "div")
          example: ["Diversion: sip:12155551212@10.10.100.12;reason=unknown;privacy=off",
                    "Resource-Priority: ets.0, wps.0"]
    verificationResponse:
      title: verificationResponse
      type: object
      properties:
        divResult:
          type: array
          description: Parameter informing of the result of the verification of diverting identities. For each verified identity, the "verstat" parameter is added to the verified identity. It includes array of one or more [div, verstatValue] tuples
          items:
            type: string
            example: ["12155551212", "TN-Validation-Passed"]
        verstatValue: 
          type: string
          description: Parameter informing of the result of the verification of originating identity. To be used in the "verstat" parameter added to the verified identity. The parameter is mandatory if the request contains a PASSporT "shaken" JSON Web Token
          example: TN-Validation-Passed
        verstatPriority: 
          type: string
          description: Parameter informing of the result of the verification of the Resource-Priority header field and optionally the header field value "psap-callback" of the Priority header field
          example: RPH-Validation-Passed
        verifyResults:
          description: Each array entry contains the verification results of a PASSporT contained in the request
          type: array
          items:
            type: object
            description: Contains the verification results of a single Identity header field contained in the identityHeader parameter or an entry in the identityHeaders array of the verification request. The "ppt" and "status" parameters are always present. The inclusion of the other parameters depends on the value of the "status" parameter
            required: 
              - ppt
              - status
            properties:
              ppt:
                type: string
                description: Identifies the type of PASSporT associated with this verifyResult entry
              status:
                type: string
                description: Identifies the verification result of the PASSporT associated with this verifyResult entry
              reasonCode:
                type: integer
                description: Identifies the failure reason code of the failing PASSporT. Optional since this is included only when the verifyResult "status" parameter has a value of "fail"
              reasonText:
                type: string
                description: Identifies the failure text associated with the failure reason code. Optional since this is included only when the verifyResult "status" parameter has a value of "fail"
              passport:
                type: string
                description: Contains the failing PASSporT. Optional since this is included only when the verifyResult "status" parameter has a value of "fail"
              validClaims:
                type: object
                description: This parameter contains the payload of the verified PASSporT. Optional since this is included only when the verifyResult "status" parameter has a value of "pass"
          example:
            - ppt: shaken
              status: pass
              validClaims: {"attest": "A , B or C","dest":{"tn":["12155551212"],"uri":null},"iat":1664199282,"orig":{"tn":"12155551211"},"origid":"123e4567-e89b-12d3-a456-426655440000"}
            - ppt: div
              status: pass
              validClaims: {"dest":{"tn":["12155551213"],"uri":null},"iat":1664199282,"orig":{"tn":"12155551211"},"div":{"tn":"121555551212","hi":null}}
            - ppt: rph
              status: pass
              validClaims: {"dest":{"tn":["12155551212"],"uri":null},"iat":1664199282,"orig":{"tn":"12155551211"},"rph":["ets.0","wps.0"]}
    divVerificationResponse:
      title: verificationResponse
      type: object
      properties:
        divResult:
          type: array
          description: Parameter informing of the result of the verification of diverting identities. For each verified identity, the "verstat" parameter is added to the verified identity. It includes array of one or more [div, verstatValue] tuples
          items:
            type: string
            example: ["12155551212", "TN-Validation-Passed"]
        verifyResults:
          description: Each array entry contains the verification results of a PASSporT contained in the request
          type: array
          items:
            type: object
            description: Contains the verification results of a single Identity header field contained in the identityHeader parameter or an entry in the identityHeaders array of the verification request. The "ppt" and "status" parameters are always present. The inclusion of the other parameters depends on the value of the "status" parameter
            required: 
              - ppt
              - status
            properties:
              ppt:
                type: string
                description: Identifies the type of PASSporT associated with this verifyResult entry
              status:
                type: string
                description: Identifies the verification result of the PASSporT associated with this verifyResult entry
              reasonCode:
                type: integer
                description: Identifies the failure reason code of the failing PASSporT. Optional since this is included only when the verifyResult "status" parameter has a value of "fail"
              reasonText:
                type: string
                description: Identifies the failure text associated with the failure reason code. Optional since this is included only when the verifyResult "status" parameter has a value of "fail"
              passport:
                type: string
                description: Contains the failing PASSporT. Optional since this is included only when the verifyResult "status" parameter has a value of "fail"
              validClaims:
                type: object
                description: This parameter contains the payload of the verified PASSporT. Optional since this is included only when the verifyResult "status" parameter has a value of "pass"
          example:
            - ppt: div
              status: pass
              validClaims: {"dest":{"tn":["12155551213"],"uri":null},"iat":1664199282,"orig":{"tn":"12155551211"},"div":{"tn":"121555551212","hi":null}}
    rphVerificationResponse:
      title: verificationResponse
      type: object
      properties:
        verstatPriority: 
          type: string
          description: Parameter informing of the result of the verification of the Resource-Priority header field and optionally the header field value "psap-callback" of the Priority header field
          example: RPH-Validation-Passed
        verifyResults:
          description: Each array entry contains the verification results of a PASSporT contained in the request
          type: array
          items:
            type: object
            description: Contains the verification results of a single Identity header field contained in the identityHeader parameter or an entry in the identityHeaders array of the verification request. The "ppt" and "status" parameters are always present. The inclusion of the other parameters depends on the value of the "status" parameter
            required: 
              - ppt
              - status
            properties:
              ppt:
                type: string
                description: Identifies the type of PASSporT associated with this verifyResult entry
              status:
                type: string
                description: Identifies the verification result of the PASSporT associated with this verifyResult entry
              reasonCode:
                type: integer
                description: Identifies the failure reason code of the failing PASSporT. Optional since this is included only when the verifyResult "status" parameter has a value of "fail"
              reasonText:
                type: string
                description: Identifies the failure text associated with the failure reason code. Optional since this is included only when the verifyResult "status" parameter has a value of "fail"
              passport:
                type: string
                description: Contains the failing PASSporT. Optional since this is included only when the verifyResult "status" parameter has a value of "fail"
              validClaims:
                type: object
                description: This parameter contains the payload of the verified PASSporT. Optional since this is included only when the verifyResult "status" parameter has a value of "pass"
          example:
            - ppt: rph
              status: pass
              validClaims: {"dest":{"tn":["12155551212"],"uri":null},"iat":1664199282,"orig":{"tn":"12155551211"},"rph":["ets.0","wps.0"]}
    divVerificationRequest:
      title: divVerificationRequest
      type: object
      required: 
        - identityHeaders
        - to
        - time
        - from
      properties:
        identityHeader:
          type: string
          description: This parameter contains the "shaken" Identity header field value to be verified
          example: null
        identityHeaders:
          type: array
          items:
            type: string
          description: This parameter contains one or more "div" and/or "rph" Identity header field values to be verified
          example: ["eyJhbGciOiJFUzI1NiIsInBwdCI6InNoYWtlbiIsInR5cCI6InBhc3Nwb3J0IiwieDV1IjoiaHR0cDovL05FVS1DMDJGRzJLN01MODU6ODA4MC9jY2lkL2F1dGhuL3YyL2NlcnRzLzExMDAxLjEwMDAxIn0.eyJhdHRlc3QiOiJBIiwiZGVzdCI6eyJ0biI6WyIxNTcxNTU1MDAwMCJdfSwiaWF0IjoxNjQ5NTM2NTMxLCJvcmlnIjp7InVyaSI6InNpcDphbGljZUBleGFtcGxlLmNvbSJ9LCJvcmlnaWQiOiJjODcyNDU3NS1iNzgxLTExZWMtYjU3NC0wMjQyYWMxMTAwMDIifQ.piGZhwqwWaKM4cOcrDTMeFKOY5UlekVDlKZTxlge4x0ERnSe9uW4400gaoVFdpGiTOzoCt9QdSfwLV_hcmvT0g;info=<http://NEU-C02FG2K7ML85:8080/ccid/authn/v2/certs/11001.10001>;alg=ES256;ppt=\"div\""]
        to: 
          type: string
          description: The destination identity taken from the To header field. Used when no "div" claim is included
          example: "sip:Bob@example.com or 12155551212"
        dest: 
          type: string
          description: The destination identity taken from the Request-URI in the incoming request
          example: "sip:Voice_Mail@example.com or 12155551213"
        time: 
          type: integer
          description: Time based on the Date header field in the incoming request
          example: 1664216863
        from: 
          type: string
          description: The asserted identity, taken from the P-Asserted-Identity or the From header field of the incoming request
          example: "sip:Alice@example.com or 12155551211"
        protectedHeaders: 
          type: array
          items:
            type: string
          description: Contains the SIP header field(s) protected by claims in the PASSporT(s) of the identityHeaders array (i.e., "rph" and/or "div")
          example: ["Diversion: sip:12155551212@10.10.100.12;reason=unknown;privacy=off"]
    rphVerificationRequest:
      title: rphVerificationRequest
      type: object
      required: 
        - identityHeaders
        - to
        - time
        - from
      properties:
        identityHeader:
          type: string
          description: This parameter contains the "shaken" Identity header field value to be verified
          example: null
        identityHeaders:
          type: array
          items:
            type: string
          description: This parameter contains one or more "div" and/or "rph" Identity header field values to be verified
          example: ["eyJhbGciOiJFUzI1NiIsInBwdCI6InNoYWtlbiIsInR5cCI6InBhc3Nwb3J0IiwieDV1IjoiaHR0cDovL05FVS1DMDJGRzJLN01MODU6ODA4MC9jY2lkL2F1dGhuL3YyL2NlcnRzLzExMDAxLjEwMDAxIn0.eyJhdHRlc3QiOiJBIiwiZGVzdCI6eyJ0biI6WyIxNTcxNTU1MDAwMCJdfSwiaWF0IjoxNjQ5NTM2NTMxLCJvcmlnIjp7InVyaSI6InNpcDphbGljZUBleGFtcGxlLmNvbSJ9LCJvcmlnaWQiOiJjODcyNDU3NS1iNzgxLTExZWMtYjU3NC0wMjQyYWMxMTAwMDIifQ.piGZhwqwWaKM4cOcrDTMeFKOY5UlekVDlKZTxlge4x0ERnSe9uW4400gaoVFdpGiTOzoCt9QdSfwLV_hcmvT0g;info=<http://NEU-C02FG2K7ML85:8080/ccid/authn/v2/certs/11001.10001>;alg=ES256;ppt=\"rph\""]
        to: 
          type: string
          description: The destination identity taken from the To header field. Used when no "div" claim is included
          example: "sip:Bob@example.com or 12155551212"
        time: 
          type: integer
          description: Time based on the Date header field in the incoming request
          example: 1664216863
        from: 
          type: string
          description: The asserted identity, taken from the P-Asserted-Identity or the From header field of the incoming request
          example: "sip:Alice@example.com or 12155551211"
        protectedHeaders: 
          type: array
          items:
            type: string
          description: Contains the SIP header field(s) protected by claims in the PASSporT(s) of the identityHeaders array (i.e., "rph" and/or "div")
          example: ["Resource-Priority:ets.0, wps.0"]
