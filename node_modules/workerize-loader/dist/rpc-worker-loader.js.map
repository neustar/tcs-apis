{"version":3,"file":"rpc-worker-loader.js","sources":["../src/rpc-worker-loader.js"],"sourcesContent":["/* global __webpack_exports__ */\n\nfunction workerSetup() {\n\taddEventListener('message', (e) => {\n\t\tlet { type, method, id, params } = e.data, f, p;\n\t\tif (type==='RPC' && method) {\n\t\t\tif ((f = __webpack_exports__[method])) {\n\t\t\t\tp = Promise.resolve().then( () => f.apply(__webpack_exports__, params) );\n\t\t\t}\n\t\t\telse {\n\t\t\t\tp = Promise.reject('No such method');\n\t\t\t}\n\t\t\tp.then(result => {\n\t\t\t\tpostMessage({ type: 'RPC', id, result });\n\t\t\t})\n\t\t\t\t.catch(e => {\n\t\t\t\t\tlet error = { message: e };\n\t\t\t\t\tif (e.stack) {\n\t\t\t\t\t\terror.message = e.message;\n\t\t\t\t\t\terror.stack = e.stack;\n\t\t\t\t\t\terror.name = e.name;\n\t\t\t\t\t}\n\t\t\t\t\tpostMessage({ type: 'RPC', id, error });\n\t\t\t\t});\n\t\t}\n\t});\n\tpostMessage({ type: 'RPC', method: 'ready' });\n}\n\nconst workerScript = '\\n' + Function.prototype.toString.call(workerSetup).replace(/(^.*\\{|\\}.*$|\\n\\s*)/g, '');\n\nexport default function rpcWorkerLoader(content, sourceMap) {\n\tconst callback = this.async();\n\tcallback(null, content + workerScript, sourceMap);\n}\n"],"names":["workerSetup","addEventListener","e","data","type","method","id","params","f","p","__webpack_exports__","Promise","resolve","then","apply","reject","result","postMessage","catch","error","message","stack","name","workerScript","Function","prototype","toString","call","replace","rpcWorkerLoader","content","sourceMap","callback","async"],"mappings":"AAAA;AAEA,SAASA,WAAT,GAAuB;AACtBC,EAAAA,gBAAgB,CAAC,SAAD,EAAY,UAACC,CAAD,EAAO;AAClC,kBAAmCA,CAAC,CAACC,IAArC;AAAA,QAAMC,IAAN,WAAMA,IAAN;AAAA,QAAYC,MAAZ,WAAYA,MAAZ;AAAA,QAAoBC,EAApB,WAAoBA,EAApB;AAAA,QAAwBC,MAAxB,WAAwBA,MAAxB;AAAA,QAA2CC,CAA3C;AAAA,QAA8CC,CAA9C;;AACA,QAAIL,IAAI,KAAG,KAAP,IAAgBC,MAApB,EAA4B;AAC3B,UAAKG,CAAC,GAAGE,mBAAmB,CAACL,MAAD,CAA5B,EAAuC;AACtCI,QAAAA,CAAC,GAAGE,OAAO,CAACC,OAAR,GAAkBC,IAAlB,CAAwB;AAAA,iBAAML,CAAC,CAACM,KAAF,CAAQJ,mBAAR,EAA6BH,MAA7B,CAAN;AAAA,SAAxB,CAAJ;AACA,OAFD,MAGK;AACJE,QAAAA,CAAC,GAAGE,OAAO,CAACI,MAAR,CAAe,gBAAf,CAAJ;AACA;;AACDN,MAAAA,CAAC,CAACI,IAAF,CAAO,UAAAG,MAAM,EAAI;AAChBC,QAAAA,WAAW,CAAC;AAAEb,UAAAA,IAAI,EAAE,KAAR;AAAeE,UAAAA,EAAE,EAAFA,EAAf;AAAmBU,UAAAA,MAAM,EAANA;AAAnB,SAAD,CAAX;AACA,OAFD,EAGEE,KAHF,CAGQ,UAAAhB,CAAC,EAAI;AACX,YAAIiB,KAAK,GAAG;AAAEC,UAAAA,OAAO,EAAElB;AAAX,SAAZ;;AACA,YAAIA,CAAC,CAACmB,KAAN,EAAa;AACZF,UAAAA,KAAK,CAACC,OAAN,GAAgBlB,CAAC,CAACkB,OAAlB;AACAD,UAAAA,KAAK,CAACE,KAAN,GAAcnB,CAAC,CAACmB,KAAhB;AACAF,UAAAA,KAAK,CAACG,IAAN,GAAapB,CAAC,CAACoB,IAAf;AACA;;AACDL,QAAAA,WAAW,CAAC;AAAEb,UAAAA,IAAI,EAAE,KAAR;AAAeE,UAAAA,EAAE,EAAFA,EAAf;AAAmBa,UAAAA,KAAK,EAALA;AAAnB,SAAD,CAAX;AACA,OAXF;AAYA;AACD,GAtBe,CAAhB;AAuBAF,EAAAA,WAAW,CAAC;AAAEb,IAAAA,IAAI,EAAE,KAAR;AAAeC,IAAAA,MAAM,EAAE;AAAvB,GAAD,CAAX;AACA;;AAED,IAAMkB,YAAY,GAAG,OAAOC,QAAQ,CAACC,SAAT,CAAmBC,QAAnB,CAA4BC,IAA5B,CAAiC3B,WAAjC,EAA8C4B,OAA9C,CAAsD,sBAAtD,EAA8E,EAA9E,CAA5B;AAEe,SAASC,eAAT,CAAyBC,OAAzB,EAAkCC,SAAlC,EAA6C;AAC3D,MAAMC,QAAQ,GAAG,KAAKC,KAAL,EAAjB;AACAD,EAAAA,QAAQ,CAAC,IAAD,EAAOF,OAAO,GAAGP,YAAjB,EAA+BQ,SAA/B,CAAR;AACA;;;;"}